# e-learning-analysis
### Цель
Выполнить анализ по результатам А/В тестированию новой механики оплаты на платформе e-learning, собрать данные из БД Clickhouse и реализовать функцию подгрузки новых данных.

### Стэк
pandas, requests, matplotlib, scipy, Clickhouse, SQL

### Выполненные задачи
1. Выгружены данные с Яндекс Диска.  
   Данные представляю собой несколько отдельных таблиц в формате csv (Данные о пользователях, Покупки, Группы А/Б тестирования) и хранятся на Яндекс Диске.
   Загрузка в датафреймы реализована с помощью requests и Яндекс API на основании словаря с ссылками.
2. Выполнена обработка и предварительный анализ данных.
   - Колонки ключи всех таблиц приведены к одному виду
   - В данных изначально отсутствуют повторения и пропуски
   - Объем данных в файле groups.csv - файл с информацией о принадлежности пользователя к контрольной или экспериментальной группе во много раз превышает объем файла active_studs.csv - файл с информацией о пользователях, которые зашли на платформу в дни проведения эксперимента. Однако тест на гомогенность дисперсий выполняется.
   - Были выявлены аномалии в данных – в датасете присутствуют пользователи, которые совершили покупку, но не заходили на сайт, что также ставит под сомнение качество исходных данных. Так как нет возможности проверить с чем это связано, считаю ошибкой и не учитываю их.
3. А/Б тест.  
   3.1. Конверсия в покупку  
   Метрика пропорция, имеет больше 5 наблюдений, а также предполагаем, что покупатели независимы друг от друга. Используем Хи‑Квадрат - p > 0.05 принимаем нулевую гипотезу - Конверсия не изменилась  
   <img src="https://raw.githubusercontent.com/truffix/e-learning-analysis/main/pic/Chisq.png" width="500" height="400">  
   
   3.2. Средняя выручка на пользователя (ARPU)  
   - Имеется аномалия в группе В  
   <img src="https://raw.githubusercontent.com/truffix/e-learning-analysis/main/pic/dist.png" width="700" height="400">  
   
   - Тест Шапиро-Уилка отвергает нормальность в обоих выборках. Используем непараметрические тесты - Критерий Колмогорова-Смирнова, а также посмотрим на результат методом Bootstrap.  
     **Конечно при планировании реального А/В теста - необходимо заранее определять каким методом мы будем пользоваться, а также проводиться перед этим А/А тест. В данном примере мы имеем только данные, поэтому используем два теста для наглядности.  
   - Тест Колмогорова-Смирнова - p<0.05 - Отвергаем нулевую гипотезу - ARPU изменилось  
   - Bootstrap - p<0.05 - Отвергаем нулевую гипотезу - ARPU изменилось   
   <img src="https://raw.githubusercontent.com/truffix/e-learning-analysis/main/pic/BS.png" width="1000" height="400">

   Таким образом, учитывая что основная метрика Конверсия в покупку стат значимо не изменилась после введения новой механики оплаты, а данные по Выручке на пользователя требуют дополнительной верификации, рекомендуется пока не вводить новую механику оплаты.  
5. SQL.
   Выгруженные данные из Clickhouse:
   - Кол-во "усердных" учеников (правильно решил 20 задач за текущий месяц) - 136 пользователей
   - Основные метрики для каждой группы
     |   | test_grp |         ARPU |       ARPAU |       CR |      CRa | CRa_math |
     |---|---------:|-------------:|------------:|---------:|---------:|---------:|
     | 0 |  control |  5049.180328 | 12031.25000 | 0.052459 | 0.117188 | 0.120000 |
     | 1 |    pilot | 15084.745763 | 45876.28866 | 0.111864 | 0.268041 | 0.162791 |
6. Реализованы функции догрузки данных А/В тестирования и построения графиков основных метрик.
   - Функция принимает на вход как ссылку, так и уже локально загруженный датафрейм и выводит основные метрики для каждой группы
   - Функция принимает датафрейм и строит сравнительные графики по основным метрикам

